<!doctype html>
<html lang='pt-BR'>

<head>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width,initial-scale=1' />
    <title>Semana 5 ‚Äî Formul√°rios e Valida√ß√£o</title>
    <link rel='stylesheet' type='text/css' href='../css/style.css' />
</head>

<body>
    <div class='container'>

        <header>
            <h1 id='sem5'>SEMANA 5 ‚Äì Formul√°rios, Valida√ß√£o e Defini√ß√£o do Banco</h1>
            <p class='lead'>Nesta semana, voc√™ ir√° definir a estrutura final do banco de dados do seu
                projeto, preparar os scripts SQL das tabelas e configurar as valida√ß√µes dos
                formul√°rios no FlutterFlow. Na pr√≥xima semana, esse banco ser√° criado no Supabase.</p>
        </header>
        <hr />

        <p>Agora que voc√™ tem o modelo conceitual do banco de dados (DER), √© hora de transformar
            esse modelo em uma <strong>estrutura real de tabelas</strong>: definindo colunas, tipos de
            dados, chaves prim√°rias e chaves estrangeiras. Nesta semana voc√™ prepara tudo isso ‚Äî
            inclusive os scripts SQL ‚Äî para que na <strong>Semana 6</strong> o banco seja criado
            diretamente no Supabase e conectado ao FlutterFlow.</p>

        <table class="box-table tip-table">
            <tr>
                <td class="box-content tip" role="note" aria-labelledby="curiosity-s5">
                    <div id="curiosity-s5" class="box-title"><img src="../images/icon-observacao.png" class="icon-img"
                            alt="Curiosidade"><strong>Voc√™ Sabia?</strong></div>
                    <div>
                        <ul>
                            <li>O <strong>brModelo Web</strong> permite exportar o DER diretamente como
                                script SQL ‚Äî basta acessar <em>Exportar ‚Üí SQL</em> ap√≥s modelar as
                                entidades e relacionamentos.</li>
                            <li>Esse script SQL pode ser colado e executado no <strong>SQL Editor do
                                    Supabase</strong> para criar todas as tabelas do projeto de uma vez,
                                sem precisar cri√°-las manualmente pela interface visual.</li>
                            <li>A valida√ß√£o de formul√°rios no frontend evita que dados incorretos cheguem
                                ao banco ‚Äî √© mais barato corrigir no in√≠cio do que depois.</li>
                        </ul>
                        <p class="small" style="margin-top: 1em; color: #666; font-style: italic;">Fonte:
                            brModelo Web Documentation; Supabase Documentation.</p>
                    </div>
                </td>
            </tr>
        </table>

        <section id='sec5-1'>
            <h2>5.1 FlutterFlow e Banco de Dados: Entendendo a Estrat√©gia</h2>
            <p>Uma d√∫vida comum neste ponto √©: <em>"o FlutterFlow tem um banco de dados local para
                    eu usar durante o desenvolvimento?"</em></p>

            <table class="box-table tip-table">
                <tr>
                    <td class="box-content tip" role="note" aria-labelledby="def-s5-nolocal">
                        <div id="def-s5-nolocal" class="box-title"><img src="../images/icon-definicao.png"
                                class="icon-img" alt="Defini√ß√£o"><strong>N√£o existe banco local no FlutterFlow</strong>
                        </div>
                        <div>
                            <p>O FlutterFlow <strong>n√£o possui um banco de dados local relacional
                                    nativo</strong> (como SQLite) sem uso de c√≥digo customizado avan√ßado.
                                O que ele oferece s√£o:
                            </p>
                            <ul>
                                <li><strong>App State:</strong> vari√°veis em mem√≥ria que s√£o perdidas
                                    ao fechar o app ‚Äî √∫teis para dados tempor√°rios de sess√£o, n√£o para
                                    persist√™ncia de dados do usu√°rio.</li>
                                <li><strong>Supabase (nuvem):</strong> banco de dados PostgreSQL real,
                                    gratuito, acessado via internet. √â o que usaremos a partir da
                                    <strong>Semana 6</strong>.
                                </li>
                            </ul>
                            <p>Por isso, a estrat√©gia adotada neste projeto √©: <strong>preparar a
                                    estrutura do banco nesta semana</strong> (scripts SQL, tipos, relacionamentos)
                                e <strong>criar o banco no Supabase na Semana 6</strong>, j√° pronto
                                para receber os dados do app.</p>
                        </div>
                    </td>
                </tr>
            </table>

            <h3>Tipos de Dados Comuns no FlutterFlow/Supabase</h3>
            <table class='content-table'>
                <caption><strong>Tabela 5.1 - </strong>Tipos de dados dispon√≠veis para as colunas das tabelas.</caption>
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Descri√ß√£o</th>
                        <th>Exemplo de Uso</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>String / Text</strong></td>
                        <td>Texto de tamanho vari√°vel</td>
                        <td>nome, descri√ß√£o, e-mail</td>
                    </tr>
                    <tr>
                        <td><strong>Integer / int8</strong></td>
                        <td>N√∫mero inteiro</td>
                        <td>id, quantidade, pontua√ß√£o</td>
                    </tr>
                    <tr>
                        <td><strong>Float / numeric</strong></td>
                        <td>N√∫mero decimal</td>
                        <td>valor, preco, peso</td>
                    </tr>
                    <tr>
                        <td><strong>Boolean / bool</strong></td>
                        <td>Verdadeiro ou falso</td>
                        <td>ativo, concluido, favorito</td>
                    </tr>
                    <tr>
                        <td><strong>Timestamp / DateTime</strong></td>
                        <td>Data e hora</td>
                        <td>created_at, data_vencimento</td>
                    </tr>
                    <tr>
                        <td><strong>UUID</strong></td>
                        <td>Identificador √∫nico universal</td>
                        <td>id (chave prim√°ria no Supabase)</td>
                    </tr>
                </tbody>
            </table>

            <p>Esses tipos de dados s√£o exatamente os que voc√™ usar√° ao criar as tabelas no
                <strong>Supabase</strong> na Semana 6. Na pr√°tica, o FlutterFlow se comunica com o Supabase
                enviando e recebendo dados nestes formatos. Entender como cada coluna se mapeia para um
                campo de formul√°rio (widget) √© a chave para construir o CRUD corretamente.
            </p>
            <p>A <strong>Figura 5.2</strong> mostra o fluxo completo de dados entre o app FlutterFlow e
                o banco de dados Supabase, evidenciando como as Actions de escrita (Insert/Update) e
                as Queries de leitura (Query Rows) transitam pela API do Supabase.</p>

            <figure class='figure'>
                <img src='../images/fig05_2_supabase_fluxo.png'
                    alt='Diagrama de arquitetura em tr√™s camadas mostrando o fluxo de dados entre FlutterFlow (frontend), API e Supabase (banco de dados)'
                    class='figure-img' />
                <figcaption class='figure-caption'><strong>Figura 5.2 ‚Äî </strong>Fluxo de dados entre FlutterFlow e
                    Supabase: cada campo do formul√°rio se traduz em uma coluna na tabela do banco.</figcaption>
            </figure>
        </section>

        <section id='sec5-2'>
            <h2>5.2 Definindo Tabelas e Relacionamentos</h2>
            <p>Com base no DER criado na semana 4, agora √© hora de definir a estrutura final das tabelas:
                nome das colunas, tipos de dados, chaves prim√°rias e estrangeiras. Prepare os scripts
                SQL nesta semana ‚Äî eles ser√£o usados para criar as tabelas no Supabase na
                <strong>Semana 6</strong>.
            </p>

            <h3>Criando a Tabela no Supabase (SQL)</h3>
            <p>Embora o Supabase tenha editor visual, conhecer o SQL equivalente ajuda a entender a
                estrutura. Veja o exemplo para o app FinanCampus:</p>

            <figure class='listing'>
                <figcaption class='listing-title'><strong>C√≥digo 5.1 - </strong>Cria√ß√£o das tabelas no Supabase (SQL)
                </figcaption>
                <pre class='code'>
-- Tabela de Categorias
CREATE TABLE categorias (
  id        UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  nome      TEXT NOT NULL,
  icone     TEXT,
  cor       TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de Despesas
CREATE TABLE despesas (
  id           UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  descricao    TEXT NOT NULL,
  valor        NUMERIC(10,2) NOT NULL,
  data         DATE NOT NULL,
  usuario_id   UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  categoria_id UUID REFERENCES categorias(id),
  created_at   TIMESTAMPTZ DEFAULT NOW()
);
                </pre>
            </figure>

            <table class="box-table tip-table">
                <tr>
                    <td class="box-content tip" role="note" aria-labelledby="tip-s5-fk">
                        <div id="tip-s5-fk" class="box-title"><img src="../images/icon-observacao.png" class="icon-img"
                                alt="Dica"><strong>Dica: Chaves Estrangeiras</strong></div>
                        <div>
                            <p>Use sempre <code>REFERENCES tabela(id)</code> para definir chaves estrangeiras
                                e garanta integridade referencial. O <code>ON DELETE CASCADE</code> indica que,
                                ao excluir o usu√°rio, suas despesas tamb√©m ser√£o exclu√≠das automaticamente.</p>
                        </div>
                    </td>
                </tr>
            </table>
        </section>

        <section id='sec5-3'>
            <h2>5.3 Planejamento das Valida√ß√µes de Formul√°rio</h2>
            <p>A <strong>valida√ß√£o</strong> garante que os dados inseridos pelo usu√°rio estejam corretos
                antes de serem salvos no banco. No FlutterFlow, a valida√ß√£o √© configurada nos campos
                do formul√°rio via <strong>Form Validation</strong> ‚Äî mas como o banco de dados ainda
                ser√° criado na <strong>Semana 6</strong>, o trabalho desta semana √© <em>planejar e
                    documentar</em> as valida√ß√µes de cada campo, para que a implementa√ß√£o seja feita
                diretamente com os widgets j√° vinculados √†s tabelas reais.</p>

            <h3>Tipos de Valida√ß√£o Comuns</h3>
            <table class='content-table'>
                <caption><strong>Tabela 5.2 - </strong>Valida√ß√µes comuns em formul√°rios de apps.</caption>
                <thead>
                    <tr>
                        <th>Tipo de Valida√ß√£o</th>
                        <th>Regra</th>
                        <th>Exemplo de Mensagem</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Campo obrigat√≥rio</strong></td>
                        <td>O campo n√£o pode estar vazio</td>
                        <td>"Este campo √© obrigat√≥rio"</td>
                    </tr>
                    <tr>
                        <td><strong>Tamanho m√≠nimo</strong></td>
                        <td>O texto deve ter ao menos N caracteres</td>
                        <td>"A senha deve ter no m√≠nimo 6 caracteres"</td>
                    </tr>
                    <tr>
                        <td><strong>Formato de e-mail</strong></td>
                        <td>O campo deve seguir o padr√£o user@domain.com</td>
                        <td>"Digite um e-mail v√°lido"</td>
                    </tr>
                    <tr>
                        <td><strong>Valor num√©rico</strong></td>
                        <td>O campo deve conter apenas n√∫meros</td>
                        <td>"Digite apenas n√∫meros"</td>
                    </tr>
                    <tr>
                        <td><strong>Valor maior que zero</strong></td>
                        <td>O n√∫mero deve ser positivo</td>
                        <td>"O valor deve ser maior que R$ 0,00"</td>
                    </tr>
                </tbody>
            </table>

            <h3>Como Documentar as Valida√ß√µes</h3>
            <p>Para cada formul√°rio do seu projeto, crie uma tabela de planejamento indicando campo
                a campo quais valida√ß√µes ser√£o aplicadas. Esse documento ser√° o guia de refer√™ncia
                na hora de configurar os formul√°rios no FlutterFlow na Semana 6.</p>

            <p>A <strong>Figura 5.1</strong> exemplifica uma tabela de planejamento completa para o
                formul√°rio "Nova Despesa" do app FinanCampus, mostrando campo, tipo de widget,
                regra de valida√ß√£o e mensagem de erro esperada.</p>

            <figure class='figure'>
                <img src='../images/fig05_1_validacao.png'
                    alt='Tabela de planejamento de valida√ß√µes do formul√°rio Nova Despesa' class='figure-img' />
                <figcaption class='figure-caption'><strong>Figura 5.1 ‚Äî </strong>Tabela de planejamento de valida√ß√µes
                    para o formul√°rio "Nova Despesa" (FinanCampus).</figcaption>
            </figure>

            <table class='content-table'>
                <caption><strong>Tabela 5.3 - </strong>Exemplo de tabela de planejamento de valida√ß√µes
                    para o formul√°rio "Nova Despesa".</caption>
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo de Widget</th>
                        <th>Valida√ß√£o</th>
                        <th>Mensagem de Erro</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Valor</td>
                        <td>TextField (num√©rico)</td>
                        <td>Obrigat√≥rio, maior que zero</td>
                        <td>"O valor deve ser maior que R$ 0,00"</td>
                    </tr>
                    <tr>
                        <td>Descri√ß√£o</td>
                        <td>TextField (texto)</td>
                        <td>Obrigat√≥rio, m√≠nimo 3 caracteres</td>
                        <td>"Descri√ß√£o obrigat√≥ria (m√≠n. 3 caracteres)"</td>
                    </tr>
                    <tr>
                        <td>Data</td>
                        <td>DatePicker</td>
                        <td>Obrigat√≥rio, n√£o permite datas futuras</td>
                        <td>"Selecione uma data v√°lida"</td>
                    </tr>
                    <tr>
                        <td>Categoria</td>
                        <td>DropDown (vinculado √† tabela <code>categorias</code>)</td>
                        <td>Obrigat√≥rio (sele√ß√£o n√£o pode ser vazia)</td>
                        <td>"Selecione uma categoria"</td>
                    </tr>
                </tbody>
            </table>

            <table class="box-table tip-table">
                <tr>
                    <td class="box-content tip" role="note" aria-labelledby="tip-s5-impl">
                        <div id="tip-s5-impl" class="box-title"><img src="../images/icon-observacao.png"
                                class="icon-img" alt="Dica"><strong>Implementa√ß√£o na Semana 6</strong></div>
                        <div>
                            <p>As valida√ß√µes ser√£o implementadas no FlutterFlow na
                                <strong>Semana 6</strong>, quando o banco de dados j√° estar√° criado
                                no Supabase e conectado ao projeto. Dessa forma, os widgets TextField
                                e DropDown ser√£o configurados <em>j√° vinculados √†s tabelas reais</em>
                                ‚Äî por exemplo, o campo Categoria j√° exibir√° as op√ß√µes carregadas
                                diretamente da tabela <code>categorias</code> do Supabase, sem
                                necessidade de reconfigura√ß√£o posterior.
                            </p>
                        </div>
                    </td>
                </tr>
            </table>

            <table class="box-table warning-table">
                <tr>
                    <td class="box-content warning" role="note" aria-labelledby="warn-s5">
                        <div id="warn-s5" class="box-title"><img src="../images/icon-importante.png" class="icon-img"
                                alt="Importante"><strong>Importante</strong></div>
                        <div>
                            <p>Nunca confie somente na valida√ß√£o do frontend. A valida√ß√£o no banco de dados
                                (constraints como <code>NOT NULL</code> e <code>CHECK</code>) √© essencial como
                                segunda camada de prote√ß√£o. As <strong>regras RLS do Supabase</strong> (Row Level
                                Security) tamb√©m protegem os dados no backend.</p>
                        </div>
                    </td>
                </tr>
            </table>
        </section>

        <section id='sec5-4'>
            <h2>5.4 Entreg√°vel da Semana</h2>

            <table class="box-table tip-table">
                <tr>
                    <td class="box-content tip" role="note" aria-labelledby="resumo-s5">
                        <div id="resumo-s5" class="box-title"><img src="../images/icon-observacao.png" class="icon-img"
                                alt="Resumo"><strong>Resumo da Semana</strong></div>
                        <div>
                            <ul>
                                <li><strong>Scripts SQL</strong> de todas as tabelas do projeto
                                    (prontos para executar no Supabase na Semana 6).</li>
                                <li><strong>Tabela de defini√ß√£o de campos</strong> (nome, tipo, obrigat√≥rio,
                                    chave) para cada tabela do projeto.</li>
                                <li><strong>Tabela de planejamento de valida√ß√µes</strong> para cada
                                    formul√°rio do projeto (campo, tipo de widget, regra de valida√ß√£o
                                    e mensagem de erro). A implementa√ß√£o no FlutterFlow acontecer√°
                                    na Semana 6, quando o banco estiver conectado.</li>
                            </ul>
                        </div>
                    </td>
                </tr>
            </table>

            <p>Na pr√≥xima semana (<strong>Semana 6</strong>), voc√™ criar√° o projeto no Supabase,
                criar√° as tabelas usando os scripts preparados aqui e conectar√° o banco ao FlutterFlow
                para come√ßar a implementar o CRUD.</p>
        </section>

        <section id='caso-sem5'>
            <h2>5.5 Estudo de Caso: FinanCampus</h2>
            <p>Veja como o grupo do <strong>FinanCampus</strong> criou o banco de dados e as valida√ß√µes nesta semana.
            </p>

            <table class="box-table tip-table">
                <tr>
                    <td class="box-content tip" role="note" aria-labelledby="caso-sem5-label">
                        <div id="caso-sem5-label" class="box-title"><img src="../images/icon-observacao.png"
                                class="icon-img" alt="Estudo de Caso"><strong>üì± Estudo de Caso ‚Äî Semana 5</strong>
                        </div>
                        <div>
                            <p><strong>Scripts SQL preparados (4 tabelas):</strong></p>
                            <ul>
                                <li><strong>categorias:</strong> id (UUID PK), nome (TEXT NOT NULL), icone (TEXT), cor
                                    (TEXT)</li>
                                <li><strong>despesas:</strong> id (UUID PK), descricao (TEXT NOT NULL), valor (NUMERIC
                                    NOT NULL), data (DATE NOT NULL), usuario_id (UUID FK), categoria_id (UUID FK)</li>
                                <li><strong>receitas:</strong> id (UUID PK), descricao (TEXT NOT NULL), valor (NUMERIC
                                    NOT NULL), data (DATE NOT NULL), usuario_id (UUID FK)</li>
                                <li><strong>perfis:</strong> id (UUID PK, FK para auth.users), nome (TEXT),
                                    orcamento_mensal (NUMERIC DEFAULT 0)</li>
                            </ul>
                            <p>Os scripts SQL est√£o prontos para serem executados no Supabase na
                                <strong>Semana 6</strong>. As tabelas ainda <strong>n√£o foram criadas
                                    no banco</strong> ‚Äî isso acontece na pr√≥xima etapa.
                            </p>
                            <p><strong>Tabela de planejamento de valida√ß√µes (formul√°rio "Nova Despesa"):</strong></p>
                            <ul>
                                <li>Campo "Valor": TextField num√©rico ‚Äî obrigat√≥rio, maior que zero.</li>
                                <li>Campo "Descri√ß√£o": TextField texto ‚Äî obrigat√≥rio, m√≠nimo 3 caracteres.</li>
                                <li>Campo "Data": DatePicker ‚Äî obrigat√≥rio, sem datas futuras.</li>
                                <li>Campo "Categoria": DropDown vinculado √† tabela <code>categorias</code> ‚Äî
                                    obrigat√≥rio.</li>
                            </ul>
                            <p>As valida√ß√µes ser√£o implementadas no FlutterFlow na <strong>Semana 6</strong>,
                                quando o banco j√° estar√° conectado e o DropDown de Categoria poder√°
                                ser vinculado diretamente √† tabela <code>categorias</code> do Supabase.</p>
                        </div>
                    </td>
                </tr>
            </table>
        </section>

        <div class="page-foot">Prof. Rafael Vargas Mesquita ‚Äî Projeto Integrador ‚Ä¢ Semana 5</div>

    </div>
</body>

</html>